import{c as i,m as $,I as x,b,a as A,d as E,p,t as d,i as a,S as y,L as V,k as w,am as I,q as L,a9 as N,a7 as k,M as C,f as M,F as T,l as z,e as R,P as H,V as q}from"./index-CNe0vCeo.js";var F=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],B=e=>i(x,$(e,{iconNode:F,name:"chevron-left"})),J=B,O=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],W=e=>i(x,$(e,{iconNode:O,name:"shield-alert"})),G=W,K=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Q=e=>i(x,$(e,{iconNode:K,name:"shield-check"})),X=Q;const Y=(e,u)=>{const[g,f]=b(!1),[t,n]=b(null),[l,r]=b(null),[s]=A(async()=>await(await fetch("https://raw.githubusercontent.com/hollow-app/hollow-registry/refs/heads/main/plugins.json")).json());return{unverified:g,checkUnverified:f,selectedPlugin:t,setSelectedPlugin:n,selectedMD:l,setSelectedMD:r,plugins:s}},Z=(e,u,g)=>({switchUnverified:n=>{e.unverified()?e.checkUnverified(!1):(n.preventDefault(),p.events.emit("confirm",{title:"warning",message:`Installing unverified plugins may pose security risks.
Only install plugins that you trust and are sure are safe.`,onAccept:()=>{e.checkUnverified(!0)}}))},action:async n=>{const l=n.currentTarget,r=e.selectedPlugin(),s=r.name,c=r.icon,h=r.action_state,m=E.vault,S=()=>new Promise(o=>setTimeout(o,2e3)),P=async()=>{const o=m.getVault().find(v=>v.url===c);o&&await m.removeItems([o.path])};if(e.setSelectedPlugin(o=>({...o,installed:null})),h==="uninstall"){l.classList.add("debounce");const o=p.events.emit("alert",{message:`Uninstalling ${s}`,type:"loading"}),v=await p.toolManager.uninstallTool(s.toLowerCase());await S(),l.classList.remove("debounce"),await P(),o(),v&&e.setSelectedPlugin(D=>({...D,installed:!1,action_state:"install"}));return}const _=h==="update";if(_){if(!await new Promise(v=>{p.events.emit("confirm",{title:"Warning",message:`Updating a plugin will require you to reload the app
Continue ?`,onAccept:()=>v(!0),onRefuse:()=>v(!1)})}))return;await P()}l.classList.add("debounce");const j=p.events.emit("alert",{message:`${_?"Updating":"Installing"} ${s}`,type:"loading"}),U=await p.toolManager.installTool(s.toLowerCase(),r.repo,_);await S(),l.classList.remove("debounce"),j(),U&&e.setSelectedPlugin(o=>({...o,installed:!0,action_state:"uninstall"}))}});var ee=d('<div><h1 class="text-xl font-bold"></h1><p class="text-secondary-40 line-clamp-1"></p><div class="text-secondary-40 mt-5 flex justify-between font-mono"><h2>by </h2><p></p></div><div class="flex justify-between"><button>'),te=d('<div class="bg-secondary-10/40 border-secondary-15 hover:bg-secondary-10 relative m-2 h-35 cursor-pointer rounded border-1 p-5 transition-all active:scale-95">');function ne(e){const[u,g]=b(!1),f=async()=>{g(!0);try{const t=await fetch(`https://raw.githubusercontent.com/${e.plugin.repo}/refs/heads/main/README.md`);if(e.plugin.verified){const s=await(await fetch(`https://api.github.com/repos/${e.plugin.repo}`,{headers:{Accept:"application/vnd.github.v3+json"}})).json();e.plugin.verified=e.plugin.verificationDate===s.updated_at}const n=await(await fetch(`https://raw.githubusercontent.com/${e.plugin.repo}/main/manifest.json`)).json(),l=p.toolManager.getHand()[e.plugin.name.toLowerCase()];e.setSelectedPlugin({...e.plugin,...n,icon:l==null?void 0:l.icon,installed:!!l,action_state:l?n.version===l.version?"uninstall":"update":"install"}),e.setSelectedMD(await I(await t.text()))}catch(t){console.log(t)}g(!1)};return(()=>{var t=te();return t.$$click=f,a(t,i(y,{get when(){return!u()},get fallback(){return i(V,{})},get children(){var n=ee(),l=n.firstChild,r=l.nextSibling,s=r.nextSibling,c=s.firstChild;c.firstChild;var h=c.nextSibling;return a(l,()=>e.plugin.name),a(r,()=>e.plugin.desc),a(c,()=>e.plugin.author,null),a(h,()=>e.plugin.version),n}})),w(()=>t.classList.toggle("pointer-events-none",!!u())),t})()}L(["click"]);var le=d('<div class="flex justify-between"><h1 class="text-4xl font-bold">Plugins</h1><div class="flex items-center"><p>Enable Unverified Plugins</p><div class=toggle-switch><input class=toggle-input id=enable-unverified-toggle type=checkbox><label class=toggle-label for=enable-unverified-toggle>'),ie=d('<input class="input my-5"placeholder=Search style=--bg-color:var(--secondary-color-10);--bg-color-f:var(--secondary-color-15)>'),re=d('<div class="grid flex-1 grid-cols-[1fr_1fr_1fr] overflow-hidden overflow-y-scroll">'),se=d('<div class="mb-5 flex justify-between"><div class=flex><button class="hover:bg-secondary-10 my-auto mr-5 h-full rounded p-2"></button><h1 class="text-5xl font-bold"></h1></div><div class="bg-secondary-10 rounded p-3">'),ae=d('<div class="flex h-fit w-full justify-between"><div class="grid w-fit grid-cols-[auto_auto] font-mono"><p class=text-secondary-40>Author</p><p></p><p class=text-secondary-40>Version</p><p></p><p class="text-secondary-40 pr-5">Description</p><p>'),ce=d('<div class="flex items-end justify-between"><a class="text-secondary-50 hover:text-secondary-90 cursor-pointer text-sm underline"target=_blank>Source Code</a><button class="button primary">'),oe=d("<div class=markdown-preview>"),de=d('<div class="bg-secondary-10/50 mt-5 box-border w-full flex-1 overflow-hidden overflow-y-scroll rounded-xl p-5">'),ue=d('<div class="flex h-full w-full items-center justify-center"><div class=chaotic-orbit>');const ge=(e,u,g,f)=>i(H,{exitBeforeEnter:!0,get children(){return i(N,{get children(){return[i(k,{get when(){return!e.selectedPlugin()},get children(){return i(C.div,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},class:"flex flex-col p-10 text-neutral-950 dark:text-neutral-100",get children(){return[(()=>{var t=le(),n=t.firstChild,l=n.nextSibling,r=l.firstChild,s=r.nextSibling,c=s.firstChild;return M(c,"click",u.switchUnverified,!0),w(()=>c.checked=e.unverified()),t})(),ie(),(()=>{var t=re();return a(t,i(y,{get when(){return e.plugins()},get children(){return i(T,{get each(){return e.plugins().filter(n=>e.unverified()||n.verified)},children:n=>i(ne,{plugin:n,get setSelectedPlugin(){return e.setSelectedPlugin},get setSelectedMD(){return e.setSelectedMD}})})}})),t})()]}})}}),i(k,{get when(){return e.selectedPlugin()},get children(){return i(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},class:"flex h-full flex-col p-10 text-neutral-950 dark:text-neutral-100",get children(){return[(()=>{var t=se(),n=t.firstChild,l=n.firstChild,r=l.nextSibling,s=n.nextSibling;return l.$$click=()=>e.setSelectedPlugin(null),a(l,i(J,{class:"size-7"})),a(r,()=>e.selectedPlugin().name),a(s,i(y,{get when(){return e.selectedPlugin().verified},get fallback(){return i(G,{class:"text-yellow-600"})},get children(){return i(X,{class:"text-green-600"})}})),t})(),(()=>{var t=ae(),n=t.firstChild,l=n.firstChild,r=l.nextSibling,s=r.nextSibling,c=s.nextSibling,h=c.nextSibling,m=h.nextSibling;return a(r,()=>e.selectedPlugin().author),a(c,()=>e.selectedPlugin().version),a(m,()=>e.selectedPlugin().desc),t})(),(()=>{var t=ce(),n=t.firstChild,l=n.nextSibling;return M(l,"click",u.action,!0),a(l,()=>e.selectedPlugin().action_state),w(()=>z(n,"href",`https://github.com/${e.selectedPlugin().repo}`)),t})(),(()=>{var t=de();return a(t,i(R,{get fallback(){return ue()},get children(){var n=oe();return w(()=>n.innerHTML=e.selectedMD()),n}})),t})()]}})}})]}})}});L(["click"]);const fe=e=>({}),he=q({create:e=>{const u=fe(),g=Y(),f=Z(g);return{helper:u,state:g,logic:f,view:(t,n,l,r)=>ge(t,n)}}});export{he as default};
