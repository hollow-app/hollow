import{c as l,m as H,I as q,b as A,o as G,d as P,G as V,p as N,t as c,i as r,k as z,l as I,S as i,ak as B,s as D,F as R,ai as X,Q,Y as U,H as Y,q as J,V as K}from"./index-CNe0vCeo.js";var O=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],T=t=>l(q,H(t,{iconNode:O,name:"check"})),W=T;const Z=(t,m)=>{const[x,g]=A(null);return G(()=>{const d=P.character.subscribe(u=>{g({...u})},{now:!0});V(()=>{d()})}),{character:x,setCharacter:g}},ee=(t,m,x)=>({import_image:async d=>{N.events.emit("show-vault",{onSelect:u=>{t.setCharacter(h=>({...h,[d]:u})),P.character.set={[d]:u}}})}});var te=c('<img alt="Character banner"class="h-full w-full object-cover">'),re=c("<img>"),ae=c('<div class="bg-secondary-90 text-secondary border-secondary absolute -right-1 -bottom-1 flex h-6 w-6 items-center justify-center rounded-lg border-2 text-xs font-bold shadow-sm">'),le=c('<div class="bg-secondary-10 border-secondary-25 w-fit rounded border-0 px-1 text-xs tracking-wide">'),ne=c('<div class=space-y-2><div class="flex justify-between text-sm"><span class="text-sm font-semibold text-neutral-600 dark:text-neutral-400">Experience</span><span class="font-medium text-neutral-500"> XP</span></div><div class="bg-secondary-10 h-1.5 overflow-hidden rounded-full"><hr class="from-primary-30 to-primary h-full border-0 bg-linear-to-r">'),se=c('<div class=space-y-3><h3 class="text-sm font-semibold text-neutral-600 dark:text-neutral-400">Meta</h3><div class="flex flex-wrap gap-2">'),ce=c('<div class="bg-secondary-10 rounded-md px-2 py-1 text-xs">+'),ie=c('<div class=space-y-3><h3 class="text-sm font-semibold text-neutral-600 dark:text-neutral-400">Achievements</h3><div class="flex flex-wrap gap-2">'),oe=c('<div class="h-full w-102 overflow-hidden"><div class="group border-secondary-05 relative h-32 w-full overflow-hidden rounded-xl border"><button class="bg-secondary-05/60 hover:bg-secondary-05 absolute top-2 right-2 flex items-center rounded p-1 text-xs opacity-0 transition-opacity group-hover:opacity-100"> Import</button></div><div class="pointer-events-none relative px-6 pb-6"><div class="pointer-events-none -mt-12 flex justify-start"><div class="pointer-events-auto relative"><div class="group border-secondary-20 bg-secondary-05 relative h-20 w-20 overflow-hidden rounded-2xl border-3 object-cover shadow-lg"><button class="bg-secondary-05/50 absolute inset-0 opacity-0 transition-opacity group-hover:opacity-100"></button></div></div></div><div class="pointer-events-auto mt-4 space-y-4 text-left"><div class=space-y-1><h2 class="text-2xl font-bold tracking-tight"></h2></div><div class="text-sm text-gray-400"><span class=text-secondary-50>Realm:</span> <span class="text-secondary-95 pl-2"></span></div><p class="text-sm leading-relaxed text-neutral-500">'),de=c('<span class="text-secondary-40 text-sm font-medium uppercase">'),ue=c('<div class="bg-secondary-10 flex w-fit items-center gap-1 rounded px-2 py-1"><span class=text-xs>'),he=c('<div class="bg-secondary-10 rounded-md px-2 py-1 text-xs">'),ve=c('<h3 class="text-sm font-medium text-neutral-700 uppercase dark:text-neutral-300">'),pe=c('<div class="absolute -top-8 right-0 flex gap-1"><button class="button secondary"style=--padding-x:var(--padding-y)></button><button class="button secondary"style=--padding-x:var(--padding-y)>'),ge=c('<div class="relative flex items-center gap-2"><div class="bg-secondary-10 flex items-center gap-1 rounded p-1"></div><div class="bg-secondary-10 relative h-1.5 flex-1 cursor-pointer rounded-full"><hr class="h-full rounded-tl-full rounded-bl-full border-0">');const me=(t,m,x,g)=>(()=>{var d=oe(),u=d.firstChild,h=u.firstChild,C=h.firstChild,E=u.nextSibling,_=E.firstChild,y=_.firstChild,b=y.firstChild,$=b.firstChild,w=_.nextSibling,k=w.firstChild,F=k.firstChild,o=k.nextSibling,v=o.firstChild,p=v.nextSibling,L=p.nextSibling,S=o.nextSibling;return r(u,l(i,{get when(){var e;return(e=t.character())==null?void 0:e.banner},get children(){var e=te();return z(()=>I(e,"src",t.character().banner)),e}}),h),h.$$click=()=>m.import_image("banner"),r(h,l(B,{class:"size-5 pr-1"}),C),r(b,l(i,{get when(){var e;return(e=t.character())==null?void 0:e.avatar},get children(){var e=re();return z(n=>{var s=t.character().avatar||"/placeholder.svg",a=t.character().name;return s!==n.e&&I(e,"src",n.e=s),a!==n.t&&I(e,"alt",n.t=a),n},{e:void 0,t:void 0}),e}}),$),$.$$click=()=>m.import_image("avatar"),r($,l(B,{class:"mx-auto p-1"})),r(y,l(i,{get when(){var e;return(e=t.character())==null?void 0:e.level},get children(){var e=ae();return r(e,()=>t.character().level),e}}),null),r(F,()=>{var e;return(e=t.character())==null?void 0:e.name}),r(k,l(i,{get when(){var e;return(e=t.character())==null?void 0:e.title},get children(){var e=le();return r(e,()=>t.character().title),e}}),null),r(L,()=>P.realm.getCurrent().name),r(w,l(i,{get when(){var e;return((e=t.character())==null?void 0:e.xp)!==void 0},get children(){var e=ne(),n=e.firstChild,s=n.firstChild,a=s.nextSibling,f=a.firstChild,M=n.nextSibling,j=M.firstChild;return r(a,()=>t.character().xp,f),z(be=>D(j,"width",`${t.character().xp/t.character().level}%`)),e}}),S),r(S,()=>{var e;return(e=t.character())==null?void 0:e.bio}),r(w,l(i,{get when(){var e;return((e=t.character())==null?void 0:e.meta.length)>0},get children(){var e=se(),n=e.firstChild,s=n.nextSibling;return r(e,l(i,{get when(){return t.character().meta.some(a=>typeof a.value=="number")},get children(){return l(R,{get each(){return t.character().meta.filter(a=>typeof a.value=="number")},children:a=>l(fe,H(()=>({...a,value:()=>a.value,setCharacter:t.setCharacter})))})}}),s),r(s,l(i,{get when(){return t.character().meta.some(a=>typeof a.value=="string")},get children(){return l(R,{get each(){return t.character().meta.filter(a=>typeof a.value=="string")},children:a=>(()=>{var f=ue(),M=f.firstChild;return r(f,l(i,{get when(){return a.icon},get children(){return l(X,{class:"size-4",get url(){return a.icon}})}}),M),r(f,l(i,{get when(){return a.label},get children(){var j=de();return r(j,()=>a.label),j}}),M),r(M,()=>a.value),f})()})}})),e}}),null),r(w,l(i,{get when(){var e;return Q(()=>{var n;return!!((n=t.character())!=null&&n.achievements)})()&&((e=t.character())==null?void 0:e.achievements.length)>0},get children(){var e=ie(),n=e.firstChild,s=n.nextSibling;return r(s,l(R,{get each(){return t.character().achievements.slice(0,10)},children:a=>(()=>{var f=he();return r(f,a),f})()}),null),r(s,l(i,{get when(){return t.character().achievements.length>10},get children(){var a=ce();return a.firstChild,r(a,()=>t.character().achievements.length-10,null),a}}),null),e}}),null),d})();function fe({id:t,label:m,icon:x,color:g,value:d,setCharacter:u}){const[h,C]=A(d()),[E,_]=A(!1);let y;const b=o=>{if(!E())return;const v=y.getBoundingClientRect();let p=(o.clientX-v.left)/v.width*100;p=Math.min(100,Math.max(0,p)),C(p)},$=()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",$)},w=o=>{_(!0),o.target.closest("button")||b(o),document.addEventListener("mousemove",b),document.addEventListener("mouseup",$)},k=()=>{_(!1),C(d())},F=()=>{P.character.setMeta({id:t,value:h()}),_(!1),u(o=>({...o,meta:[...o.meta.map(v=>v.id===t?{...v,value:h()}:v)]}))};return V(()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",$)}),(()=>{var o=ge(),v=o.firstChild,p=v.nextSibling,L=p.firstChild;r(v,l(X,{class:"size-4",style:{color:g},url:x}),null),r(v,l(i,{when:m,get children(){var e=ve();return r(e,m),e}}),null),p.$$mousedown=w;var S=y;return typeof S=="function"?Y(S,p):y=p,D(L,"background",`linear-gradient(to right, color-mix(in oklab, transparent, ${g}), ${g})`),r(p,l(i,{get when(){return E()},get children(){var e=pe(),n=e.firstChild,s=n.nextSibling;return n.$$click=F,r(n,l(W,{class:"size-4"})),s.$$click=k,r(s,l(U,{class:"size-4"})),e}}),null),z(e=>{var n=`${h().toFixed(0)}%`,s=`${h()}%`;return n!==e.e&&I(p,"title",e.e=n),s!==e.t&&D(L,"width",e.t=s),e},{e:void 0,t:void 0}),o})()}J(["click","mousedown"]);const xe=t=>({}),_e=K({create:t=>{const m=xe(),x=Z(),g=ee(x);return{helper:m,state:x,logic:g,view:(d,u,h,C)=>me(d,u)}}});export{_e as default};
