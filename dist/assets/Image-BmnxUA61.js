import{c as s,m as L,I as S,b as u,o as Y,G as z,t as v,i as g,k as D,l as M,s as F,S as p,Q as N,q as U,p as I}from"./index-CNe0vCeo.js";var X=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],R=c=>s(S,L(c,{iconNode:X,name:"image"})),V=R,q=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],G=c=>s(S,L(c,{iconNode:q,name:"move"})),H=G,Q=v('<img class="h-full w-full"style=-webkit-user-drag:none>'),T=v('<button class="absolute top-2 right-2 rounded-full bg-black/50 p-2 text-white transition-all duration-200 hover:bg-black/70">'),B=v('<div class="bg-secondary/50 absolute bottom-2 left-2 size-fit rounded px-2 py-1 text-center backdrop-blur-sm"><p class="text-secondary-95 text-sm">'),J=v('<div class="h-full w-full"><div class="bg-secondary-10/40 relative flex h-full items-center justify-center overflow-hidden rounded-lg">');function O({data:c,card:d,store:A,toolEvents:y}){const[o,l]=u(c),[_,h]=u(!1),[f,b]=u({x:0,y:0}),[C,x]=u(!1),E=(a,n)=>{if(o().objectFit==="cover"){h(!0),b({x:a.clientX,y:a.clientY});const e=i=>{i.clientX-f().x;const m=i.clientY-f().y;l(r=>({...r,position:{x:Math.max(0,Math.min(100,r.position.x-0)),y:Math.max(0,Math.min(100,r.position.y-m/5))}})),b({x:i.clientX,y:i.clientY})},t=()=>{h(!1),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),k()};document.addEventListener("mousemove",e),document.addEventListener("mouseup",t)}},k=async()=>{A.set(d.id,o())},P=a=>{if(a){l(n=>({...n,url:a}));return}I.events.emit("show-vault",{onSelect:n=>l(e=>({...e,url:n}))})},w=()=>{const a={tool:"Image",card:d.data.name,save:k,options:[{label:"Image",description:"Upload or provide image URL",type:"file",onAction:P,value:o().url},{type:"segmented",label:"Fit Mode",description:"How the image should fit in its container",value:o().objectFit,onAction:n=>{l(e=>({...e,objectFit:n,...n==="cover"?{position:{x:50,y:50}}:{}}))},options:[{key:"contain",title:"contain"},{key:"cover",title:"cover"},{key:"fill",title:"fill"},{key:"none",title:"none"},{key:"scale-down",title:"scale-down"}]},{type:"text",label:"Caption",description:"Add a caption to your image",value:o().caption,onAction:n=>l(e=>({...e,caption:n}))},{type:"text",label:"Alt Text",description:"Add alternative text for accessibility",value:o().alt,onAction:n=>l(e=>({...e,alt:n}))}]};I.events.emit("tool-settings",a)};return Y(()=>{y.on(`${d.id}-settings`,w)}),z(()=>{y.off(`${d.id}-settings`,w)}),(()=>{var a=J(),n=a.firstChild;return n.addEventListener("mouseleave",()=>x(!1)),n.addEventListener("mouseenter",()=>x(!0)),g(n,s(p,{get when(){return o().url},get fallback(){return s(V,{class:"h-16 w-16 text-gray-900 opacity-50 dark:text-gray-50"})},get children(){return[(()=>{var e=Q();return D(t=>{var i=o().url,m=o().alt,r=!!(o().objectFit==="cover"&&_()),$=o().objectFit,j=o().objectFit==="cover"?`${o().position.x}% ${o().position.y}%`:"center";return i!==t.e&&M(e,"src",t.e=i),m!==t.t&&M(e,"alt",t.t=m),r!==t.a&&e.classList.toggle("cursor-move",t.a=r),$!==t.o&&F(e,"object-fit",t.o=$),j!==t.i&&F(e,"object-position",t.i=j),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),e})(),s(p,{get when(){return N(()=>o().objectFit==="cover")()&&C()},get children(){var e=T();return e.$$mousedown=t=>E(t),g(e,s(H,{size:16})),e}}),s(p,{get when(){return o().caption},get children(){var e=B(),t=e.firstChild;return g(t,()=>o().caption),e}})]}})),a})()}U(["mousedown"]);export{O as default};
